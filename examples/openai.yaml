rules:
  # Mock OpenAI chat completions for development
  - match:
      method: [POST]
      path: /openai/v1/chat/completions
    response: |
      +1s
      [200]
      headers:
        Content-Type: application/json
      body
      {
        "id": "chatcmpl-{{ uuid }}",
        "object": "chat.completion",
        "created": 1677652288,
        "model": "gpt-4",
        "choices": [
          {
            "index": 0,
            "message": {
              "role": "assistant",
              "content": "This is a mocked response from Mockingbird. In production, this would be a real OpenAI response."
            },
            "finish_reason": "stop"
          }
        ],
        "usage": {
          "prompt_tokens": 10,
          "completion_tokens": 20,
          "total_tokens": 30
        }
      }

  # Proxy all other OpenAI requests to real API
  - match:
      method: [GET, POST]
      path: /openai/**
    proxyto: https://api.openai.com
    headers:
      Authorization: "Bearer {{ config `OPENAI_API_KEY` }}"
